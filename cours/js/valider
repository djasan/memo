Notre application contient dÃ©sormais un formulaire qui permet aux utilisateurs de saisir des donnÃ©es. Notre objectif est maintenant de pouvoir vÃ©rifier que lâ€™utilisateur a saisi correctement ces donnÃ©es : 

    Les champs requis sont-ils tous renseignÃ©s ?

    Lâ€™e-mail saisi est-il correctement Ã©crit ?

Pour rÃ©pondre Ã  cette problÃ©matique dans ce chapitre, nous allons mettre en place des rÃ¨gles de validation, en allant du plus simple au plus complexe :

    vÃ©rifier la valeur dâ€™un champ pour les cas simples ;

    dÃ©finir des expressions rÃ©guliÃ¨res pour les cas plus complexes.

Câ€™est parti ! ğŸš€
VÃ©rifiez la valeur dâ€™un champ

Une rÃ¨gle de validation est une maniÃ¨re de sâ€™assurer quâ€™un champ est correctement rempli. Pour y parvenir, lâ€™option la plus simple est de sâ€™assurer que le champ nâ€™est pas vide.

    Par exemple, le formulaire de notre application contient  un champ â€œnomâ€. Si lâ€™utilisateur le laisse vide et que utilisons cette donnÃ©e pour envoyer un mail, notre destinataire ne pourra pas savoir qui est Ã  lâ€™origine de cet envoi !

Pour Ã©viter ce genre dâ€™erreur, nous devons nous assurer que le champ est bien renseignÃ© par lâ€™utilisateur. Cette vÃ©rification peut Ãªtre rÃ©alisÃ©e Ã  deux Ã©tapes clÃ©s :

    Ã  lâ€™envoi du formulaire ;

    Ã  la saisie de chaque champ du formulaire. 

VÃ©rifiez un champ Ã  lâ€™envoi du formulaire

    Reprenons le code dâ€™un formulaire trÃ¨s simple avec nos deux champs, nom et e-mail :

<form>

    <!-- champ nom -->

    <label for="nom">Nom</label>

    <input type="text" id="nom" name="nom" placeholder="Votre nom">


    <!-- champ email -->

    <label for="email">Email</label>

    <input type="email" id="email" name="email" placeholder="Votre email">


    <!-- bouton de validation -->

    <button>Envoyer</button>

</form>

Pour vÃ©rifier si le champ â€œnomâ€ nâ€™est pas vide, Ã  la soumission, nous allons donc :

    Ã©couter lâ€™Ã©vÃ©nement submit sur le formulaire ;

    rÃ©cupÃ©rer la valeur de ce champ ;

    rÃ©aliser notre test.

const form = document.querySelector('form');


// Ajout d'un Ã©couteur d'Ã©vÃ©nement sur le formulaire pour Ã©couter le submit

form.addEventListener("submit", (event) => {

    // On empÃªche le comportement par dÃ©faut

    event.preventDefault();


    // On fait la vÃ©rification.

    const baliseNom = document.getElementById('nom');

    const valeurNom = baliseNom.value;

    if (valeurNom === "") {

        console.log('Le champ nom est vide');

    } else {

        console.log('Le champ nom est rempli');

    }

});

Dans ce code, jâ€™ai  :

    Ã©coutÃ© l'Ã©vÃ©nement submit sur le formulaire ;

    fait un preventDefault pour Ã©viter un rechargement de la page ;

    vÃ©rifiÃ© la valeur du champ ;

    affichÃ© un message dans la console pour vÃ©rifier.

Dans notre cas ici, si on rentre un espace dans le champ, il nâ€™est pas vide, car il contient bien un caractÃ¨re. Pour autant, on ne peut pas dire quâ€™il soit correctement rempli. Câ€™est pourquoi la bonne pratique consiste Ã  nettoyer les champs avant de les tester. En utilisant la mÃ©thode trim(), vous pouvez ainsi nettoyer le champ et supprimer automatiquement les espaces et autres tabulations autour de la chaÃ®ne Ã  tester !
VÃ©rifiez un champ Ã  la saisie dâ€™un champ du formulaire

Pour vÃ©rifier la valeur dâ€™un champ Ã  la saisie, le principe est le mÃªme. Nous allons Ã©couter un Ã©vÃ©nement. Deux types d'Ã©vÃ©nements sont possibles dans ce cas :

    lâ€™Ã©vÃ©nement input : il se dÃ©clenche Ã  chaque fois que lâ€™utilisateur tape une lettre dans le champ ;

    lâ€™Ã©vÃ©nement change : il se dÃ©clenche quand lâ€™utilisateur a fini de taper, et sÃ©lectionne un autre Ã©lÃ©ment de la page.  

    Voici un exemple avec change, mais nâ€™hÃ©sitez pas Ã  essayer input pour voir la diffÃ©rence de comportement.

const baliseNom = document.getElementById('nom');

baliseNom.addEventListener('change', (event) => {

    const valeurNom = event.target.value;

    if (valeurNom === "") {

        console.log('Le champ nom est vide');

    } else {

        console.log('Le champ nom est rempli');

    }

});

Ici jâ€™Ã©coute lâ€™Ã©vÃ©nement input qui va se produire Ã  chaque fois que jâ€™Ã©cris dans le champ baliseNom.
RÃ©capitulons en vidÃ©o

Vous pouvez revoir ces dÃ©monstrations dans la vidÃ©o ci-dessous :
RÃ©alisez une validation complexe avec les expressions rÃ©guliÃ¨res

Le test que nous avons rÃ©alisÃ© Ã©tait trÃ¨s simple : est-ce que le champ est vide ou non. Mais comment faire pour savoir si un texte correspond au format dâ€™une adresse e-mail ? Dans ce cas, nous allons utiliser les expressions rÃ©guliÃ¨res !
DÃ©couvrez les expressions rÃ©guliÃ¨res

Le principe des expressions rÃ©guliÃ¨res est de dÃ©crire, dans un format prÃ©cis, lâ€™ensemble des chaÃ®nes de caractÃ¨res possibles, puis de tester si la chaÃ®ne de caractÃ¨res correspond Ã  ce format. Les expressions rÃ©guliÃ¨res sont Ã©galement appelÃ©es RegEx ou RegExp, pour â€œRegular Expressionâ€, en anglais.

    Illustrons avec un exemple pour rendre cela plus concret ! ğŸ˜ƒ Imaginons que nous voulions vÃ©rifier quâ€™une chaÃ®ne de caractÃ¨res ne contient que des lettres : pas de chiffre, pas dâ€™espace.

Dans ce cas, nous allons crÃ©er une expression rÃ©guliÃ¨re qui va dÃ©crire un format oÃ¹ seules les lettres sont autorisÃ©es :

let chaine = "cachalot"; // Testez avec des chiffres pour voir la diffÃ©rence

let regex = new RegExp("^[a-z]+$");

let resultat = regex.test(chaine);

console.log(resultat); // Affiche true.

Dans ce code :

    jâ€™ai dÃ©clarÃ© une variable chaÃ®ne avec un mot ;

    jâ€™ai dÃ©clarÃ© un objet RegExp avec le mot-clÃ© new, et je lui ai passÃ© entre parenthÃ¨ses lâ€™expression rÃ©guliÃ¨re qui dÃ©crit mon format. 

Au final, cette expression dit : â€œNous voulons une chaÃ®ne de caractÃ¨res qui commence et qui finit par un ou plusieurs caractÃ¨res compris entre a et z.â€ Revenons en dÃ©tail sur son  contenu :

    ^  : signifie que la chaÃ®ne doit commencer par ce qui suit ;

    [a-z]+  : signifie que la chaÃ®ne doit avoir des lettres comprises entre a et z. Le  +  signifie quâ€™il faut au minimum une seule lettre entre a et z. 

    $  : signifie que la chaÃ®ne doit finir par ce qui prÃ©cÃ¨de. 

Voici quelques exemples dâ€™expressions rÃ©guliÃ¨res simples :

    [a-z]  : une lettre entre a et z ;

    [a-zA-Z]  : une lettre entre a et z ou A et Z ; 

    [a|b]  : une lettre : a ou b, Ã  lâ€™exclusion de toutes les autres ;

    \d  : nâ€™importe quel chiffre ;

    \w  : nâ€™importe quelle lettre ;

    \d{3}  : au moins trois chiffres.

Tous ces Ã©lÃ©ments peuvent se combiner pour dÃ©crire prÃ©cisÃ©ment le format que nous voulons tester. Nâ€™hÃ©sitez pas Ã  consulter la documentation pour en savoir plus !

Et maintenant, passons Ã  la pratique et regardons ensemble comment vÃ©rifier une adresse e-mail. ğŸ˜ƒ
DÃ©finissez une expression rÃ©guliÃ¨re pour vÃ©rifier une adresse e-mail

Dans cette situation, votre premier rÃ©flexe doit Ãªtre de vous poser la question suivante : quâ€™est-ce qui caractÃ©rise une adresse e-mail ?

    Prenons quelques exemples valides et non valides :

        david@openclassrooms.com : lâ€™adresse est valide. 

        david.pierru@openclassrooms.com : lâ€™adresse est valide.

        david-pierru@open-classrooms.com : lâ€™adresse est valide.

        david.openclassrooms.com : lâ€™adresse nâ€™est pas valide car il manque le @.

        david@openclassrooms : lâ€™adresse nâ€™est pas valide car il manque l'extension. 

Cela fait beaucoup de rÃ¨glesâ€¦ ğŸ˜… Nous allons donc construire notre expression rÃ©guliÃ¨re petit Ã  petit. Je vous invite dâ€™ailleurs Ã  utiliser ce site pour y parvenir. Il permet de tester en direct notre expression. 

Lâ€™expression que nous allons construire va vÃ©rifier le format suivant :

â€œnom @ fournisseur . extensionâ€. Cela nous fait 5 Ã©tapes : une pour le nom, une pour le @, une pour le fournisseur, une pour le point et la derniÃ¨re pour lâ€™extension.
Ã‰tape 1 : vÃ©rifiez le nom

Une adresse e-mail commence par plusieurs lettres ou chiffres. Il est Ã©galement possible dâ€™avoir des tirets  -  ou des points  .  . Nous pouvons donc commencer par Ã©crire comme expression :

[a-z0-9._-]+

Cela signifie que nous voulons au moins un caractÃ¨re qui correspond Ã  ce qui est entre crochets. Donc un caractÃ¨re qui soit :

    une lettre entre a et z ;

    un chiffre entre 0 et 9 ;

    le caractÃ¨re  .  ;

    le caractÃ¨re  _  ;

    le caractÃ¨re  -  .

Ã‰tape 2 : vÃ©rifiez lâ€™arobase

Ensuite il nous faut un @. Nous Ã©crirons donc :

[a-z0-9._-]+@

Ã‰tape 3 : vÃ©rifiez le fournisseur

Puis nous avons Ã  nouveau un mot (le fournisseur). Nous Ã©crirons donc :

[a-z0-9._-]+@[a-z0-9._-]+

Ã‰tape 4 : vÃ©rifiez le point

Le  .  Ã©tant utilisÃ© comme symbole dans les expressions rÃ©guliÃ¨res, nous devrons l'Ã©chapper, c'est-Ã -dire expliquer Ã  lâ€™interprÃ©teur que ce  .  doit Ãªtre considÃ©rÃ© comme le caractÃ¨re  .  , et pas interprÃ©tÃ©.

[a-z0-9._-]+@[a-z0-9._-]+\.

Ã‰tape 5 : vÃ©rifiez l'extension

Et finalement, nous voulons ajouter l'extension :

[a-z0-9._-]+@[a-z0-9._-]+\.[a-z0-9._-]+

Lâ€™expression dans son ensemble signifie donc : un caractÃ¨re ou plus, suivi dâ€™un @, suivi dâ€™un caractÃ¨re ou plus, suivi dâ€™un point, suivi dâ€™un caractÃ¨re ou plus : nous avons nos 5 Ã©tapes !

Pas trÃ¨s facile Ã  lire, tout Ã§aâ€¦ ğŸ¤¨

Effectivementâ€¦ Et pourtant cette expression pourrait encore Ãªtre plus prÃ©cise. Pour lâ€™instant, un e-mail qui commence par un chiffre est valide, par exemple.

Il nâ€™est pas toujours facile de trouver lâ€™Ã©quilibre entre une expression simple, qui peut laisser passer quelques erreurs, et une expression exhaustive mais trÃ¨s compliquÃ©e Ã  rÃ©aliser. Je vais donc vous donner un dernier conseil pour rÃ©diger vos expressions rÃ©guliÃ¨res : utilisez ce site. Il vous permettra de visualiser les expressions gÃ©nÃ©rÃ©es pour faciliter leur lecture.

La preuve en image ci-dessous :
Capture d'Ã©cran du site Regexper. L'expression rÃ©guliÃ¨re est visualisÃ©e au milieu d'un Ã©cran.
Le site Regexper vous permet de visualiser lâ€™expression rÃ©guliÃ¨re pour tester un e-mail
RÃ©capitulons en vidÃ©o

Vous pouvez revoir ces dÃ©monstrations dans la vidÃ©o ci-dessous :
Ã€ vous de jouer

Notre application contient un formulaire. Mais pour lâ€™instant, rien ne permet de vÃ©rifier que les champs sont correctement renseignÃ©s avant de lancer lâ€™e-mail. Câ€™est donc tout le but de cet exercice.

Pour ce faire :

    Ã‰crivez une fonction validerNom qui va prendre le nom Ã  tester en paramÃ¨tre et retourner true si le nom est valide, false sinon.

        La fonction doit prendre le nom en paramÃ¨tre et valider quâ€™il est correct. 

        La rÃ¨gle est dâ€™avoir un champ avec au moins deux caractÃ¨res. 

    Ã‰crivez une fonction validerEmail qui va prendre en paramÃ¨tre lâ€™e-mail Ã  tester et retourner true si lâ€™e-mail est valide, false sinon. 

    Utilisez ces deux fonctions avec lâ€™Ã©vÃ©nement submit du formulaire. 

    Si les deux champs sont valides, affichez lâ€™e-mail. Sinon, affichez seulement un message dâ€™erreur dans la console. 

CorrigÃ©

Vous pouvez vÃ©rifier votre travail en consultant le corrigÃ© et la vidÃ©o ci-dessous :
En rÃ©sumÃ©

    Mettez en place des rÃ¨gles de validation pour vous assurer que lâ€™utilisateur a correctement saisi ses donnÃ©es : 

        vÃ©rifiez la valeur dâ€™un champ pour les cas simples ;

        dÃ©finissez des expressions rÃ©guliÃ¨res pour les cas plus complexes.

    Vous pouvez tester vos champs : 

        Ã  lâ€™envoi du formulaire grÃ¢ce Ã  lâ€™Ã©vÃ©nement submit ;

        Ã  la saisie dâ€™un champ du formulaire grÃ¢ce aux Ã©vÃ©nements input ou change.

    DÃ©finissez vos expressions rÃ©guliÃ¨res Ã©tape par Ã©tape en vous aidant des sites ci-dessous : 

        regex101.com pour tester votre expression ;

        Regexper pour visualiser votre expression.
